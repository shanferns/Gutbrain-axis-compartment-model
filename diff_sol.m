% -------------------- Clear Environment and Initialize --------------------

clear all   % Clear all variables from the workspace
clc         % Clear the command window
format long % Set numeric display format to long precision
tStart = tic;  % Start timing the execution of the script

% -------------------- Define Model Parameters --------------------

sympathetic = 0;  % Initialize sympathetic nervous system activity (0 = inactive)/(1 = active)

% -------------------- Initial Conditions for ODE System --------------------

y0 = [ 0.000558976338511752,  0.974573744638073,  1.45709983103238e-06,  0.354657696734714,  9.81178285088552, ...
       0.100002549820054,     0.00165690255837193, 2.93674867264871,    15.0632513273513,    0.00183288902475595, ...
      23.9943599487003,      0.00211564044001297, 0.00169152183491876, -70,                -70, ...
       8.84228090634526e-05,  0.954073913638169,  4.43676153295407e-06,  0.937997900351777,  0.999566357839555, ...
       0.0198581545752995,    0.000558976338511752,  0.974573744638073,  1.45709983103238e-06,  0.354657696734714, ...
       9.81178285088552,      0.100002549820054,  0.00165690255837193,  2.93674867264871,   15.0632513273513, ...
       0.00183288902475595,  23.9943599487003,    0.00211564044001297,  0.00169152183491876,  1.02506883291055, ...
       0.000558976338511752,  0.974573744638073,  1.45709983103238e-06,  0.354657696734714,  9.81178285088552, ...
       0.100002549820054,     0.00165690255837193, 2.93674867264871,    15.0632513273513,    0.00183288902475595, ...
      23.9943599487003,      0.00211564044001297, 0.00169152183491876, -70,                -70, ...
       8.84228090634526e-05,  0.954073913638169,  4.43676153295407e-06,  0.937997900351777,  0.999566357839555, ...
       0.0198581545752995,    0.000558976338511752,  0.974573744638073,  1.45709983103238e-06,  0.354657696734714, ...
       9.81178285088552,      0.100002549820054,  0.00165690255837193,  2.93674867264871,   15.0632513273513, ...
       0.00183288902475595,  23.9943599487003,    0.00211564044001297,  0.00169152183491876,  1.02506883291055, ...
       680 ];

% -------------------- Define Simulation Time Span --------------------

t_span = [0 100];  % Define simulation time span (from 0 to 300 seconds)

% -------------------- Solve System of Differential Equations --------------------

% The function `Compartment_efferent` defines the system of ODEs modeling the compartments.
% `ode15s` is a stiff solver suitable for this type of system.

[time, y] = ode15s(@Compartment_gut_brain_axis, t_span, y0, [], sympathetic);

% -------------------- Display Execution Time --------------------

toc(tStart);  % Display the elapsed time for the simulation

% -------------------- Plot a Specific Output Variable --------------------

figure(71)          
plot(time, y(:,71)); % Display emptying

